<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="hello.fclover.mybatis.mapper.NoticeMapper">

    <select id="getListCount" resultType="int">
        select count(*) from notice
    </select>

    <select id="getBoardList" parameterType="map" resultType="notice">
        SELECT noti_no as notiNo,
               noti_title as notiTitle,
               noti_name as notiName,
               noti_content as notiContent,
               noti_date as notiDate
        FROM notice
        ORDER BY noti_date DESC
            LIMIT #{start}, #{limit}
    </select>

    <insert id="insertNotice">
        <selectKey resultType="int" order="BEFORE" keyProperty="notino" keyColumn="noti_no">
            select IFNULL(max(noti_no), 0) + 1 from notice
        </selectKey>
        insert into notice
        (noti_no,
        noti_title, noti_name,
        noti_content, noti_date)
        values
        (#{notino},
        #{notititle}, #{notiname},
        #{noticontent}, now())
    </insert>

    <select id="getDetail" parameterType="int" resultType="notice">
        SELECT noti_no as notiNo,
               noti_title as notiTitle,
               noti_name as notiName,
               noti_content as notiContent,
               noti_date as notiDate
        FROM notice
        WHERE noti_no = #{num}
    </select>

    <select id="getSearchList" parameterType="map" resultType="notice">
        SELECT noti_no as notiNo,
               noti_title as notiTitle,
               noti_name as notiName,
               noti_content as notiContent,
               noti_date as notiDate
        FROM notice
        WHERE noti_title LIKE  #{search_word}
        ORDER BY noti_date DESC
            LIMIT #{start}, #{size}
    </select>


    <select id="getSearchListCount" resultType="int">
        select  count(*)
        from notice
        <where>
            <if test="search_word != null and search_word != ''">
                noti_title LIKE #{search_word}
            </if>
        </where>
    </select>

</mapper>
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap JS and dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>
    <title>상품 검색 및 리스트</title>

    <style>
        .search-section {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 30px;
        }
        .resizer {
            cursor: col-resize;
            position: absolute;
            right: 0;
            top: 0;
            bottom: 0;
            width: 5px;
            z-index: 1;
            pointer-events: all;
        }
        table {
            table-layout: auto;
            width: max-content; /* 내용에 맞게 테이블 크기 설정 */
            border-collapse: collapse;
        }

        th, td {
            border: 1px solid #ccc;
            text-align: center;
            vertical-align: middle;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 10em; /* 기본 최대 길이: 10자 */
        }

        th {
            background-color: #f8f9fa;
            font-weight: bold;
            position: relative; /* resizer 위치를 위해 필요 */
            min-width: 50px; /* 최소 너비 설정 */
        }

        /* 테이블을 감싸는 div에 스크롤바 추가 */
        .table-wrapper {
            width: 100%;
            overflow-x: auto; /* 가로 스크롤 활성화 */
            -webkit-overflow-scrolling: touch; /* 부드러운 스크롤 */
        }
    </style>
</head>
<body>
<div class="container mt-5">
    <h2 class="text-center mb-4">상품 검색 및 리스트</h2>

    <!-- 검색 영역 -->
    <div class="search-section">
        <form action="/search-products" method="GET">
            <div class="row g-3">
                <!-- 카테고리 -->
                <div class="col-md-3">
                    <label for="category" class="form-label">카테고리</label>
                    <select class="form-select" id="category" name="category">
                        <option value="" selected>전체</option>
                        <option value="fiction">소설</option>
                        <option value="non-fiction">논픽션</option>
                        <option value="history">역사</option>
                        <option value="science">과학</option>
                    </select>
                </div>

                <!-- 상품명 -->
                <div class="col-md-3">
                    <label for="productName" class="form-label">상품명</label>
                    <input type="text" class="form-control" id="productName" name="productName"
                           placeholder="상품명을 입력하세요">
                </div>

                <!-- 상품 저자 -->
                <div class="col-md-3">
                    <label for="author" class="form-label">상품 저자</label>
                    <input type="text" class="form-control" id="author" name="author" placeholder="저자명을 입력하세요">
                </div>

                <!-- 출판사 -->
                <div class="col-md-3">
                    <label for="publisher" class="form-label">출판사</label>
                    <input type="text" class="form-control" id="publisher" name="publisher" placeholder="출판사를 입력하세요">
                </div>
            </div>

            <div class="row g-3 mt-2">
                <!-- 등록일 범위 (시작일) -->
                <div class="col-md-3">
                    <label for="startDate" class="form-label">등록일 (시작)</label>
                    <input type="date" class="form-control" id="startDate" name="startDate">
                </div>

                <!-- 등록일 범위 (종료일) -->
                <div class="col-md-3">
                    <label for="endDate" class="form-label">등록일 (종료)</label>
                    <input type="date" class="form-control" id="endDate" name="endDate">
                </div>

                <!-- 검색 버튼 -->
                <div class="col-md-6 d-flex align-items-end justify-content-end">
                    <button type="submit" class="btn btn-primary me-2">
                        <span><img src="../images/seller/search.png" alt="search" style="width: 16px; height: 16px;"></span>
                        검색
                    </button>
                    <button type="reset" class="btn btn-secondary"><span>
                        <img src="../images/seller/reset.png" alt="reset" style="width: 16px; height: 16px;"></span>
                        초기화
                    </button>
                </div>
            </div>
        </form>
    </div>

    <!-- 검색 결과 리스트 예시 -->
    <div class="table-wrapper">
        <h4 class="mb-3">검색 결과</h4>
        <table class="table table-bordered resizable-table">
            <thead class="table-light">
            <tr>
                <th>수정</th>
                <th>삭제</th>
                <th>카테고리</th>
                <th>상품명</th>
                <th>상품 설명</th>
                <th>상품 가격</th>
                <th>저자</th>
                <th>출판사</th>
                <th>상품 발행일</th>
                <th>상품 등록일</th>
                <th>상품 페이지수</th>
                <th>상품 크기</th>
                <th>저자 설명</th>
                <th>등록 일자</th>
                <th>수정 일자</th>
            </tr>
            </thead>
<!--           단순 예시-->
            <tbody>
            <tr>
                <td><button class="btn btn-warning">수정</button></td>
                <td><button class="btn btn-danger">삭제</button></td>
                <td>소설</td>
                <td>해리포터와 불의 잔</td>
                <td>마법과 모험의 세계를 그린 판타지 소설</td>
                <td>15,000원</td>
                <td>J.K. 롤링</td>
                <td>문학출판사</td>
                <td>2024-01-01</td>
                <td>2023-12-15</td>
                <td>350</td>
                <td>15cm x 21cm</td>
                <td>세계적인 베스트셀러 작가로 유명한 J.K. 롤링은...</td>
                <td>2023-12-15</td>
                <td>2023-12-16</td>
            </tr>
            <tr>
                <td><button class="btn btn-warning">수정</button></td>
                <td><button class="btn btn-danger">삭제</button></td>
                <td>역사</td>
                <td>세계사 이야기</td>
                <td>세계 각국의 역사적 사건들을 다룬 책</td>
                <td>20,000원</td>
                <td>홍길동</td>
                <td>역사출판사</td>
                <td>2023-11-20</td>
                <td>2023-11-10</td>
                <td>400</td>
                <td>18cm x 25cm</td>
                <td>저자 홍길동은 역사학자이자 작가로...</td>
                <td>2023-11-10</td>
                <td>2023-11-12</td>
            </tr>
            <tr>
                <td><button class="btn btn-warning">수정</button></td>
                <td><button class="btn btn-danger">삭제</button></td>
                <td>자기계발</td>
                <td>성공을 위한 습관</td>
                <td>자기계발을 위한 필독서</td>
                <td>18,000원</td>
                <td>이수진</td>
                <td>성공출판사</td>
                <td>2023-10-15</td>
                <td>2023-10-05</td>
                <td>280</td>
                <td>16cm x 23cm</td>
                <td>저자 이수진은 동기 부여와 목표 설정 전문가로...</td>
                <td>2023-10-05</td>
                <td>2023-10-07</td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
<script>
    document.querySelectorAll('th').forEach((th) => {
        const resizer = document.createElement('span');
        resizer.classList.add('resizer');
        th.style.position = 'relative'; // 부모 요소 상대 위치
        th.appendChild(resizer);

        let startX, startWidth;

        resizer.addEventListener('mousedown', (e) => {
            e.preventDefault();
            startX = e.clientX;
            startWidth = th.offsetWidth;

            const onMouseMove = (moveEvent) => {
                const newWidth = startWidth + (moveEvent.clientX - startX);
                if (newWidth > 50) { // 최소 너비 제한
                    th.style.width = `${newWidth}px`;

                    // 해당 열의 모든 셀 크기 동기화
                    const table = th.closest('table');
                    const colIndex = Array.from(th.parentNode.children).indexOf(th);

                    table.querySelectorAll('tbody tr').forEach((row) => {
                        const cell = row.children[colIndex];
                        if (cell) {
                            cell.style.width = `${newWidth}px`;
                            cell.style.maxWidth = `${newWidth}px`; // 최대 크기 동기화
                            cell.style.overflow = 'hidden';
                            cell.style.textOverflow = 'ellipsis';
                            cell.style.whiteSpace = 'nowrap';
                        }
                    });

                    // 테이블의 전체 폭 강제 갱신
                    const tableWrapper = table.closest('.table-wrapper');
                    tableWrapper.scrollLeft = tableWrapper.scrollLeft; // 스크롤 상태 유지
                }
            };

            const onMouseUp = () => {
                document.removeEventListener('mousemove', onMouseMove);
                document.removeEventListener('mouseup', onMouseUp);
            };

            document.addEventListener('mousemove', onMouseMove);
            document.addEventListener('mouseup', onMouseUp);
        });
    });
</script>

</body>
</html>
